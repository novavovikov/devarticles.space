---
cover: cover.jpeg
date: 2021-07-06
title: React 18. –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
description: React 18 –¥–æ–±–∞–≤–ª—è–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –≤—ã–ø–æ–ª–Ω—è—è –±–æ–ª—å—à–µ –ø–∞–∫–µ—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –í —ç—Ç–æ–º –ø–æ—Å—Ç–µ –±—É–¥–µ—Ç –æ–±—ä—è—Å–Ω–µ–Ω–æ, —á—Ç–æ —Ç–∞–∫–æ–µ –ø–∞–∫–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –∫–∞–∫ –æ–Ω–æ —Ä–∞–±–æ—Ç–∞–ª–æ —Ä–∞–Ω—å—à–µ –∏ —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å.
tags:
- react
- javascript
---

## –ß—Ç–æ —Ç–∞–∫–æ–µ –ø–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞?

–ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ React **–≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –æ–¥–∏–Ω —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥** –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

–ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –¥–≤–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –∫–ª–∏–∫–∞ –ø–æ –∫–Ω–æ–ø–∫–µ, —Ç–æ React –≤—Å–µ–≥–¥–∞ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –∏—Ö
–≤ –æ–¥–∏–Ω —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥. –ï—Å–ª–∏ –≤—ã –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥, –≤—ã —É–≤–∏–¥–∏—Ç–µ, —á—Ç–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –≤—ã –Ω–∞–∂–∏–º–∞–µ—Ç–µ, —Ç–æ React –≤—ã–ø–æ–ª–Ω–∏—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥, —Ö–æ—Ç—è –≤—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–≤–∞–∂–¥—ã:

```jsx
function App() {
  const [count, setCount] = useState(0);
  const [flag, setFlag] = useState(false);

  function handleClick() {
    setCount(c => c + 1); // –ï—â–µ –Ω–µ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç
    setFlag(f => !f); // –ï—â–µ –Ω–µ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç
    // React –≤—ã–ø–æ–ª–Ω–∏—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –≤ –∫–æ–Ω—Ü–µ (—ç—Ç–æ –∏ –µ—Å—Ç—å –ø–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞!)
  }

  return (
    <div>
      <button onClick={handleClick}>Next</button>
      <h1 style={{ color: flag ? "blue" : "black" }}>{count}</h1>
    </div>
  );
}
```
üìÉ [–î–µ–º–æ: Rect 17 –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π](https://codesandbox.io/s/spring-water-929i6?file=/src/index.js). (–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –æ–¥–∏–Ω —Ä–µ–Ω–¥–µ—Ä –Ω–∞ –∫–ª–∏–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏.)

–≠—Ç–æ –æ—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –ø–æ—Å–∫–æ–ª—å–∫—É –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –Ω–µ–Ω—É–∂–Ω—ã—Ö –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö —Ä–µ–Ω–¥–µ—Ä–æ–≤.
–≠—Ç–æ —Ç–∞–∫–∂–µ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ—Ç—Ä–∏—Å–æ–≤–∫—É –≤–∞—à–µ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ —Å –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º, —á—Ç–æ –º–æ–≥–ª–æ –±—ã –≤—ã–∑–≤–∞—Ç—å –æ—à–∏–±–∫–∏.

–≠—Ç–æ –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç —Ä–∞–±–æ—Ç—É –æ—Ñ–∏—Ü–∏–∞–Ω—Ç–∞: –û–Ω –¥–æ–∂–∏–¥–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –≤—ã —Å–¥–µ–ª–∞–µ—Ç–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–µ—Å—å –∑–∞–∫–∞–∑, –∞ –Ω–µ –±–µ–∂–∏—Ç –∫–∞–∂–¥—ã–π —Ä–∞–∑ –Ω–∞ –∫—É—Ö–Ω—é,
–∫–æ–≥–¥–∞ –≤—ã –æ–∑–≤—É—á–∏–≤–∞–µ—Ç–µ –±–ª—é–¥–æ.

–û–¥–Ω–∞–∫–æ React –Ω–µ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ –æ—Ç–Ω–æ—Å–∏–ª—Å—è –∫ –ø–∞–∫–µ—Ç–Ω—ã–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, –∞ –∑–∞—Ç–µ–º
–æ–±–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ `handleClick`, —Ç–æ React –ù–ï –±—É–¥–µ—Ç –ø–∞–∫–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç –¥–≤–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.

–≠—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ React —Ä–∞–Ω—å—à–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –≤–æ –≤—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è –±—Ä–∞—É–∑–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–ª–∏–∫–∞), 
–Ω–æ –∑–¥–µ—Å—å –º—ã –æ–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ —Å–æ–±—ã—Ç–∏–µ —É–∂–µ –±—ã–ª–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ (–≤ –æ–±—Ä–∞—Ç–Ω–æ–º –≤—ã–∑–æ–≤–µ fetch):

```jsx
function App() {
  const [count, setCount] = useState(0);
  const [flag, setFlag] = useState(false);

  function handleClick() {
    fetchSomething().then(() => {
      // React 17 –∏ –±–æ–ª–µ–µ —Ä–∞–Ω–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ –ù–ï –æ–±—ä–µ–¥–∏–Ω—è—é—Ç –∏—Ö –≤ –ø–∞–∫–µ—Ç—ã, –ø–æ—Ç–æ–º—É —á—Ç–æ
      // –æ–Ω–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –ø–æ—Å–ª–µ —Å–æ–±—ã—Ç–∏—è –≤ callback, –∞ –Ω–µ –≤–æ –≤—Ä–µ–º—è –µ–≥–æ
      setCount(c => c + 1); // –í—ã–∑—ã–≤–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä
      setFlag(f => !f); // –í—ã–∑—ã–≤–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä
    });
  }

  return (
    <div>
      <button onClick={handleClick}>Next</button>
      <h1 style={{ color: flag ? "blue" : "black" }}>{count}</h1>
    </div>
  );
}
```
üìÉ [–î–µ–º–æ: React 17 –ù–ï –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–∞–∫–µ—Ç–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –≤–Ω–µ—à–Ω–∏—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π.](https://codesandbox.io/s/trusting-khayyam-cn5ct?file=/src/index.js) (–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –¥–≤–∞ —Ä–µ–Ω–¥–µ—Ä–∞ –Ω–∞ –∫–ª–∏–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏.)

–î–æ React 18 –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–ª–∏—Å—å —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π React. –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ –ø—Ä–æ–º–∏—Å–æ–≤, setTimeout,
–Ω–∞—Ç–∏–≤–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π –∏–ª–∏ –ª—é–±–æ–≥–æ –¥—Ä—É–≥–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–ª–∏—Å—å –≤ React.

### –ß—Ç–æ —Ç–∞–∫–æ–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π?

–ù–∞—á–∏–Ω–∞—è —Å React 18 —Å [createRoot](/articles/react-18-create-root), –≤—Å–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –æ—Ç–∫—É–¥–∞ –æ–Ω–∏ –∏—Å—Ö–æ–¥—è—Ç.

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ setTimeouts, –ø—Ä–æ–º–∏—Å–æ–≤, –Ω–∞—Ç–∏–≤–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π –∏–ª–∏ –ª—é–±–æ–≥–æ –¥—Ä—É–≥–æ–≥–æ —Å–æ–±—ã—Ç–∏—è 
–±—É–¥—É—Ç –ø–∞–∫–µ—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è —Ç–∞–∫ –∂–µ, –∫–∞–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ —Å–æ–±—ã—Ç–∏–π React. –û–∂–∏–¥–∞–µ—Ç—Å—è, —á—Ç–æ —ç—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –º–µ–Ω—å—à–µ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É
–æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∏, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –∫ –ø–æ–≤—ã—à–µ–Ω–∏—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ –≤–∞—à–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö:

```jsx
function App() {
  const [count, setCount] = useState(0);
  const [flag, setFlag] = useState(false);

  function handleClick() {
    fetchSomething().then(() => {
      // React 18 –∏ –±–æ–ª–µ–µ –ø–æ–∑–¥–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ –î–ï–õ–ê–Æ–¢ –ø–∞–∫–µ—Ç–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É:
      setCount(c => c + 1);
      setFlag(f => !f);
      // React –≤—ã–ø–æ–ª–Ω–∏—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –≤ –∫–æ–Ω—Ü–µ (—ç—Ç–æ –∏ –µ—Å—Ç—å –ø–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞!)
    });
  }

  return (
    <div>
      <button onClick={handleClick}>Next</button>
      <h1 style={{ color: flag ? "blue" : "black" }}>{count}</h1>
    </div>
  );
}
```
üìÉ [–î–µ–º–æ: React 18 —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π —Å–æ–±—ã—Ç–∏–π –≤ createRoot –¥–∞–∂–µ –≤–Ω–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π!](https://codesandbox.io/s/morning-sun-lgz88?file=/src/index.js) (–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –æ–¥–∏–Ω —Ä–µ–Ω–¥–µ—Ä –Ω–∞ –∫–ª–∏–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏!)

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ.** –û–∂–∏–¥–∞–µ—Ç—Å—è, —á—Ç–æ –≤—ã [–æ–±–Ω–æ–≤–∏—Ç–µ—Å—å –¥–æ createRoot](/articles/react-18-create-root). 
> –°—Ç–∞—Ä–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–æ–º —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —É–ø—Ä–æ—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ —Å –æ–±–µ–∏–º–∏ –≤–µ—Ä—Å–∏—è–º–∏.

React –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–∞–∫–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –≥–¥–µ –æ–Ω–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç, –ø–æ—ç—Ç–æ–º—É —ç—Ç–æ:

```jsx
function handleClick() {
  setCount(c => c + 1);
  setFlag(f => !f);
  // React –≤—ã–ø–æ–ª–Ω–∏—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –≤ –∫–æ–Ω—Ü–µ (—ç—Ç–æ –∏ –µ—Å—Ç—å –ø–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞!)
}
```

–≤–µ–¥—ë—Ç —Å–µ–±—è —Ç–∞–∫ –∂–µ –∫–∞–∫ —ç—Ç–æ:

```jsx
setTimeout(() => {
  setCount(c => c + 1);
  setFlag(f => !f);
  // React –≤—ã–ø–æ–ª–Ω–∏—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –≤ –∫–æ–Ω—Ü–µ (—ç—Ç–æ –∏ –µ—Å—Ç—å –ø–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞!)
}, 1000);
```

–∏ —Ç–∞–∫ –∂–µ –∫–∞–∫ —ç—Ç–æ:

```jsx
fetch(/*...*/).then(() => {
  setCount(c => c + 1);
  setFlag(f => !f);
  // React –≤—ã–ø–æ–ª–Ω–∏—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –≤ –∫–æ–Ω—Ü–µ (—ç—Ç–æ –∏ –µ—Å—Ç—å –ø–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞!)
})
```

–∏ –∫–∞–∫ —ç—Ç–æ:

```jsx
elm.addEventListener('click', () => {
  setCount(c => c + 1);
  setFlag(f => !f);
  // React –≤—ã–ø–æ–ª–Ω–∏—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –≤ –∫–æ–Ω—Ü–µ (—ç—Ç–æ –∏ –µ—Å—Ç—å –ø–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞!)
});
```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ.** React –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø–∞–∫–µ—Ç–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ —ç—Ç–æ –≤–æ–æ–±—â–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ.
> –ù–∞–ø—Ä–∏–º–µ—Ä, React –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —Å–æ–±—ã—Ç–∏—è,
> —Ç–∞–∫–æ–≥–æ –∫–∞–∫ –∫–ª–∏–∫ –∏–ª–∏ –Ω–∞–∂–∞—Ç–∏–µ –∫–ª–∞–≤–∏—à–∏, DOM –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–Ω–æ–≤–∏—Ç—Å—è –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º —Å–æ–±—ã—Ç–∏–µ–º.
> –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–æ —Ñ–æ—Ä–º–∞, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ, –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –¥–≤–∞–∂–¥—ã.


## –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ —è –Ω–µ —Ö–æ—á—É –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–∞–∫–µ—Ç–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É?

–û–±—ã—á–Ω–æ –ø–∞–∫–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ, –Ω–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–π –∫–æ–¥ –º–æ–∂–µ—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç —á—Ç–µ–Ω–∏—è —á–µ–≥–æ-–ª–∏–±–æ –∏–∑ DOM —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ 
–∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è. –í —ç—Ç–∏—Ö —Å–ª—É—á–∞—è—Ö –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ReactDOM.flushSync()`, —á—Ç–æ–±—ã –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è –æ—Ç –ø–∞–∫–µ—Ç–Ω–æ–π
–æ–±—Ä–∞–±–æ—Ç–∫–∏:

```jsx
import { flushSync } from 'react-dom'; // Note: react-dom, not react

function handleClick() {
  flushSync(() => {
    setCounter(c => c + 1);
  });
  // React —É–∂–µ –æ–±–Ω–æ–≤–∏–ª DOM
  flushSync(() => {
    setFlag(f => !f);
  });
  // React —É–∂–µ –æ–±–Ω–æ–≤–∏–ª DOM
}
```

–û–∂–∏–¥–∞–µ—Ç—Å—è, —á—Ç–æ —ç—Ç–æ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö.

## –≠—Ç–æ —á—Ç–æ-–Ω–∏–±—É–¥—å —Å–ª–æ–º–∞–µ—Ç –¥–ª—è —Ö—É–∫–æ–≤?

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Ö—É–∫–∏, —Ç–æ –æ–∂–∏–¥–∞–µ—Ç—Å—è, —á—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –±—É–¥–µ—Ç "–ø—Ä–æ—Å—Ç–æ —Ä–∞–±–æ—Ç–∞—Ç—å" 
–≤ –ø–æ–¥–∞–≤–ª—è—é—â–µ–º –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤.

## –≠—Ç–æ —á—Ç–æ-–Ω–∏–±—É–¥—å —Å–ª–æ–º–∞–µ—Ç –¥–ª—è –∫–ª–∞—Å—Å–æ–≤?

–ò–º–µ–π—Ç–µ –≤ –≤–∏–¥—É, —á—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–æ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π React –≤—Å–µ–≥–¥–∞ –±—ã–ª–∏ –ø–∞–∫–µ—Ç–Ω—ã–º–∏, 
–ø–æ—ç—Ç–æ–º—É –¥–ª—è —ç—Ç–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –Ω–µ—Ç –Ω–∏–∫–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π.

–í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö –∫–ª–∞—Å—Å–∞ –µ—Å—Ç—å –∫—Ä–∞–π–Ω–∏–µ —Å–ª—É—á–∞–∏, –∫–æ–≥–¥–∞ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–æ–π.

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫–ª–∞—Å—Å–∞ –∏–º–µ–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ –º–æ–∂–Ω–æ –±—ã–ª–æ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —á–∏—Ç–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ —Å–æ–±—ã—Ç–∏–π.
–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—ã —Å–º–æ–∂–µ—Ç–µ —á–∏—Ç–∞—Ç—å `this.state` –º–µ–∂–¥—É –≤—ã–∑–æ–≤–∞–º–∏ `setState`:

```jsx
handleClick = () => {
  setTimeout(() => {
    this.setState(({ count }) => ({ count: count + 1 }));

    // { count: 1, flag: false }
    console.log(this.state);

    this.setState(({ flag }) => ({ flag: !flag }));
  });
};
```

–í React 18 —ç—Ç–æ —É–∂–µ –Ω–µ —Ç–∞–∫. –ü–æ—Å–∫–æ–ª—å–∫—É –≤—Å–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–∂–µ –≤ setTimeout —è–≤–ª—è—é—Ç—Å—è –ø–∞–∫–µ—Ç–Ω—ã–º–∏, React –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç
–ø–µ—Ä–≤–æ–≥–æ setState —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–æ –≤—Ä–µ–º—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ç–∏–∫–∞ –±—Ä–∞—É–∑–µ—Ä–∞. –ò—Ç–∞–∫, —Ä–µ–Ω–¥–µ—Ä –µ—â–µ –Ω–µ –ø—Ä–æ–∏–∑–æ—à–µ–ª:

```jsx
handleClick = () => {
  setTimeout(() => {
    this.setState(({ count }) => ({ count: count + 1 }));

    // { count: 0, flag: false }
    console.log(this.state);

    this.setState(({ flag }) => ({ flag: !flag }));
  });
};
```
üìÉ [–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å sandbox](https://codesandbox.io/s/interesting-rain-hkjqw?file=/src/App.js).

–ï—Å–ª–∏ —ç—Ç–æ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é –¥–æ React 18, –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ReactDOM.flushSync` –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è,
–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ —Å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é:

```jsx
handleClick = () => {
  setTimeout(() => {
    ReactDOM.flushSync(() => {
      this.setState(({ count }) => ({ count: count + 1 }));
    });

    // { count: 1, flag: false }
    console.log(this.state);

    this.setState(({ flag }) => ({ flag: !flag }));
  });
};
```

üìÉ [–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å sandbox.](https://codesandbox.io/s/hopeful-minsky-99m7u?file=/src/App.js)

–≠—Ç–∞ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å —Ö—É–∫–∞–º–∏, 
–ø–æ—Ç–æ–º—É —á—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –∏–∑ `useState`:

```jsx
function handleClick() {
  setTimeout(() => {
    console.log(count); // 0
    setCount(c => c + 1);
    setCount(c => c + 1);
    setCount(c => c + 1);
    console.log(count); // 0
  }, 1000)
}
```

–•–æ—Ç—è —Ç–∞–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –º–æ–≥–ª–æ –ø–æ–∫–∞–∑–∞—Ç—å—Å—è –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º, –∫–æ–≥–¥–∞ –≤—ã –ø—Ä–∏–º–µ–Ω–∏–ª–∏ —Ö—É–∫–∏, –æ–Ω–æ –æ—Ç–∫—Ä—ã–ª–æ –ø—É—Ç—å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

## –ê —á—Ç–æ –Ω–∞—Å—á–µ—Ç `unstable_batchedUpdates`?

–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ React –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç—Ç–æ—Ç –Ω–µ–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è `setState` –≤–Ω–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π:

```jsx
import { unstable_batchedUpdates } from 'react-dom';

unstable_batchedUpdates(() => {
  setCount(c => c + 1);
  setFlag(f => !f);
});
```

–≠—Ç–æ—Ç API –≤—Å–µ –µ—â–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –≤ –Ω–µ–º –±–æ–ª—å—à–µ –Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø–∞–∫–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
–ö–æ–º–∞–Ω–¥–∞ React –Ω–µ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç —É–¥–∞–ª—è—Ç—å –µ–≥–æ –≤ –±–ª–∏–∂–∞–π—à–∏—Ö —Ä–µ–ª–∏–∑–∞—Ö, —Ö–æ—Ç—è –æ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å —É–¥–∞–ª–µ–Ω –≤ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –ø–æ—Å–ª–µ —Ç–æ–≥–æ,
–∫–∞–∫ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –ø–µ—Ä–µ—Å—Ç–∞–Ω—É—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –µ–≥–æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è.

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ë–µ–∑ —Å–æ–º–Ω–µ–Ω–∏—è, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ–∏—á–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ—Ä–∞–¥—É–µ—Ç –≤—Å–µ—Ö.
–° –ø–æ–º–æ—â—å—é –≤—Å–µ–≥–æ –ª–∏—à—å –æ–¥–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ—Ä–Ω–µ –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è React –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –±–æ–ª—å—à—É—é –≥–∏–±–∫–æ—Å—Ç—å
–∏ –ª—É—á—à—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å. 

–≠—Ç–æ —Ç–æ, —á–µ–≥–æ —è –∂–¥—É –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ, –Ω–∞—Ä—è–¥—É —Å –Ω–æ–≤—ã–º–∏ API.
